<html>
  <head>
    <title>RouteFinder, dojo implementation</title>
	<link rel="stylesheet" href="styles/main.css" />
    <script src='js/dojo/dojo/dojo.js' djConfig="parseOnLoad: true "></script>
    <script> 
		// register so dojo can find the routeFinder module, takes a path relative to the dojo.js file
		dojo.registerModulePath('routeFinder', '../../routeFinder');

		dojo.require('routeFinder.layer');
		
		dojo.addOnLoad(function() {
			dojo.connect(dojo.byId('b'), 'onclick', function() {
				dojo.publish(routeFinder.topics.onAddressAdded, ['17129 E Kent Dr, Aurora, CO, 80013']);
			});
			
			var addressesNode = dojo.byId('addressInput');

			dojo.connect(dojo.byId('addressInput'), 'onkeyup', function(evt, two) {
				if (evt.keyCode === dojo.keys.ENTER) {
					lines = addressesNode.value.split(/\r\n|\r|\n/);
					dojo.forEach(lines, function(singleLine) {
						if (0 !== singleLine.length) {
							dojo.publish(routeFinder.topics.onAddressAdded, [singleLine]);
						}
					});
					addressesNode.value = '';
					addressesNode.focus();
				}
			});
			
			addressesNode.focus();
		});
    </script>
  </head>
  <body>
  <div>
	<textarea id="addressInput"></textarea>
  </div>
  <input id='b' type="button" value="lookup address" />
  
  <div id="locationList"></div>
  </body>
</html>